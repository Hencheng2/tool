<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modern Web Designer Tool</title>
    <!-- Monaco Editor from CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs/loader.js"></script>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --dark-bg: #1e1e1e;
            --darker-bg: #161616;
            --sidebar-bg: #252526;
            --accent-color: #007acc;
            --accent-hover: #0062a3;
            --text-color: #e0e0e0;
            --border-color: #444;
            --success-color: #4CAF50;
            --danger-color: #f44336;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--dark-bg);
            color: var(--text-color);
            height: 100vh;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .header {
            background-color: var(--darker-bg);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--border-color);
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--accent-color);
        }

        .view-toggle {
            display: flex;
            background-color: var(--sidebar-bg);
            border-radius: 5px;
            overflow: hidden;
        }

        .view-toggle button {
            background: none;
            border: none;
            color: var(--text-color);
            padding: 8px 15px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .view-toggle button.active {
            background-color: var(--accent-color);
        }

        .view-toggle button:hover:not(.active) {
            background-color: var(--border-color);
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .sidebar {
            width: 250px;
            background-color: var(--sidebar-bg);
            padding: 15px;
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
        }

        .elements-category {
            margin-bottom: 20px;
        }

        .category-title {
            font-size: 1rem;
            margin-bottom: 10px;
            color: var(--accent-color);
            padding-bottom: 5px;
            border-bottom: 1px solid var(--border-color);
        }

        .elements-list {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }

        .element-item {
            background-color: var(--dark-bg);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            cursor: grab;
            transition: all 0.2s;
            user-select: none;
        }

        .element-item:hover {
            background-color: var(--accent-hover);
            border-color: var(--accent-color);
        }

        .element-item:active {
            cursor: grabbing;
        }

        .work-area-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .work-area-toolbar {
            padding: 10px 15px;
            background-color: var(--darker-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .toolbar-button {
            background-color: var(--sidebar-bg);
            border: 1px solid var(--border-color);
            color: var(--text-color);
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .toolbar-button:hover {
            background-color: var(--accent-hover);
        }

        .delete-button {
            background-color: var(--danger-color);
            margin-left: auto;
        }

        .delete-button:hover {
            background-color: #d32f2f;
        }

        .work-area {
            flex: 1;
            overflow: auto;
            background-color: #2d2d30;
            background-image: 
                linear-gradient(45deg, #252526 25%, transparent 25%), 
                linear-gradient(-45deg, #252526 25%, transparent 25%), 
                linear-gradient(45deg, transparent 75%, #252526 75%), 
                linear-gradient(-45deg, transparent 75%, #252526 75%);
            background-size: 20px 20px;
            background-position: 0 0, 0 10px, 10px -10px, -10px 0px;
            display: flex;
            justify-content: center;
            padding: 20px;
        }

        #design-area {
            width: 100%;
            min-height: 100%;
            background-color: #fff;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .code-panel {
            width: 600px;
            background-color: var(--darker-bg);
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .code-tabs {
            display: flex;
            background-color: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
        }

        .code-tab {
            padding: 10px 20px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .code-tab.active {
            background-color: var(--accent-color);
        }

        .code-container {
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        .editor {
            width: 100%;
            height: 100%;
        }

        .copy-button {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
            background-color: var(--success-color);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .copy-button:hover {
            opacity: 1;
        }

        .element-properties {
            margin-top: 20px;
            padding-top: 10px;
            border-top: 1px solid var(--border-color);
        }

        .property-group {
            margin-bottom: 15px;
        }

        .property-label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.9rem;
        }

        .property-input {
            width: 100%;
            padding: 8px;
            background-color: var(--dark-bg);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-color);
        }

        .color-input {
            height: 40px;
        }

        .hidden {
            display: none;
        }

        /* Preview mode styling */
        .preview-mode .sidebar,
        .preview-mode .code-panel,
        .preview-mode .work-area-toolbar {
            display: none;
        }

        .preview-mode .work-area-container {
            width: 100%;
        }

        .preview-mode .work-area {
            padding: 0;
            background: none;
        }

        /* Element styles */
        .element {
            position: absolute;
            cursor: move;
            border: 2px dashed transparent;
            user-select: none;
            min-width: 50px;
            min-height: 30px;
        }

        .element.selected {
            border-color: var(--accent-color);
        }

        .element:hover {
            border-color: rgba(0, 122, 204, 0.5);
        }

        .element-content {
            width: 100%;
            height: 100%;
            overflow: auto;
        }

        .resize-handle {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: var(--accent-color);
            z-index: 10;
        }

        .nw { top: -5px; left: -5px; cursor: nw-resize; }
        .ne { top: -5px; right: -5px; cursor: ne-resize; }
        .sw { bottom: -5px; left: -5px; cursor: sw-resize; }
        .se { bottom: -5px; right: -5px; cursor: se-resize; }

        /* Specific element styles */
        .navbar {
            width: 100%;
            background-color: #333;
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-between;
        }

        .button {
            padding: 10px 20px;
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
        }

        .image-placeholder {
            background-color: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #777;
            border: 2px dashed #999;
            width: 100%;
            height: 100%;
        }

        .modal {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            padding: 20px;
            color: #333;
        }

        .text-element {
            padding: 10px;
            min-width: 100px;
            min-height: 40px;
        }

        .form-element {
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
        }

        .form-group {
            margin-bottom: 10px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 15px;
            color: #333;
        }

        .video-container {
            background-color: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            width: 100%;
            height: 100%;
        }

        .scroll-container {
            overflow: auto;
            padding: 10px;
            background-color: #f5f5f5;
            border-radius: 5px;
        }

        .element-actions {
            position: absolute;
            top: -30px;
            right: 0;
            display: flex;
            gap: 5px;
        }

        .element-action {
            background-color: var(--accent-color);
            color: white;
            border: none;
            border-radius: 3px;
            padding: 3px 6px;
            cursor: pointer;
            font-size: 12px;
        }

        .element-action.delete {
            background-color: var(--danger-color);
        }

        /* Preview specific styles */
        .preview-mode .element {
            border: none;
            cursor: default;
        }

        .preview-mode .element:hover {
            border: none;
        }

        .preview-mode .resize-handle {
            display: none;
        }

        /* Page size indicator */
        .page-size {
            margin-left: 15px;
            color: #aaa;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <div class="logo">WebDesign Pro</div>
            <div class="view-toggle">
                <button id="design-view-btn" class="active">Design View</button>
                <button id="preview-view-btn">Preview View</button>
            </div>
        </header>

        <div class="main-content">
            <aside class="sidebar">
                <div class="elements-category">
                    <h3 class="category-title">Basic Elements</h3>
                    <div class="elements-list">
                        <div class="element-item" draggable="true" data-type="button">Button</div>
                        <div class="element-item" draggable="true" data-type="text">Text</div>
                        <div class="element-item" draggable="true" data-type="image">Image</div>
                        <div class="element-item" draggable="true" data-type="div">Container</div>
                    </div>
                </div>

                <div class="elements-category">
                    <h3 class="category-title">Navigation</h3>
                    <div class="elements-list">
                        <div class="element-item" draggable="true" data-type="navbar">Navbar</div>
                        <div class="element-item" draggable="true" data-type="menu">Menu</div>
                        <div class="element-item" draggable="true" data-type="tabs">Tabs</div>
                    </div>
                </div>

                <div class="elements-category">
                    <h3 class="category-title">Content</h3>
                    <div class="elements-list">
                        <div class="element-item" draggable="true" data-type="card">Card</div>
                        <div class="element-item" draggable="true" data-type="modal">Modal</div>
                        <div class="element-item" draggable="true" data-type="form">Form</div>
                        <div class="element-item" draggable="true" data-type="video">Video</div>
                    </div>
                </div>

                <div class="elements-category">
                    <h3 class="category-title">Layout</h3>
                    <div class="elements-list">
                        <div class="element-item" draggable="true" data-type="section">Section</div>
                        <div class="element-item" draggable="true" data-type="scroll-container">Scroll Container</div>
                        <div class="element-item" draggable="true" data-type="grid">Grid</div>
                        <div class="element-item" draggable="true" data-type="accordion">Accordion</div>
                    </div>
                </div>

                <div class="element-properties">
                    <h3 class="category-title">Properties</h3>
                    <div class="property-group">
                        <label class="property-label">Background Color</label>
                        <input type="color" class="property-input color-input" id="prop-bg-color" value="#ffffff">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Width</label>
                        <input type="text" class="property-input" id="prop-width" placeholder="e.g., 100px or 50%">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Height</label>
                        <input type="text" class="property-input" id="prop-height" placeholder="e.g., 100px or 50%">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Text Color</label>
                        <input type="color" class="property-input color-input" id="prop-text-color" value="#000000">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Text Content</label>
                        <textarea class="property-input" id="prop-text-content" rows="3"></textarea>
                    </div>
                    <div class="property-group">
                        <label class="property-label">Link URL</label>
                        <input type="text" class="property-input" id="prop-link-url" placeholder="https://example.com">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Font Size</label>
                        <input type="text" class="property-input" id="prop-font-size" placeholder="e.g., 16px">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Border Radius</label>
                        <input type="text" class="property-input" id="prop-border-radius" placeholder="e.g., 5px">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Image URL</label>
                        <input type="text" class="property-input" id="prop-image-url" placeholder="https://example.com/image.jpg">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Video URL</label>
                        <input type="text" class="property-input" id="prop-video-url" placeholder="https://example.com/video.mp4">
                    </div>
                    <div class="property-group">
                        <label class="property-label">Scroll Behavior</label>
                        <select class="property-input" id="prop-scroll-behavior">
                            <option value="auto">Auto</option>
                            <option value="smooth">Smooth</option>
                        </select>
                    </div>
                </div>
            </aside>

            <div class="work-area-container">
                <div class="work-area-toolbar">
                    <button class="toolbar-button" id="export-html">Export HTML</button>
                    <button class="toolbar-button" id="import-html">Import HTML</button>
                    <button class="toolbar-button" id="clear-all">Clear All</button>
                    <button class="toolbar-button delete-button" id="delete-element">Delete Selected</button>
                    <span class="page-size" id="page-size-indicator">Page: 1200×800</span>
                </div>
                <div class="work-area">
                    <div id="design-area"></div>
                </div>
            </div>

            <div class="code-panel">
                <div class="code-tabs">
                    <div class="code-tab active" data-tab="html">HTML</div>
                    <div class="code-tab" data-tab="css">CSS</div>
                    <div class="code-tab" data-tab="js">JavaScript</div>
                </div>
                <div class="code-container">
                    <div id="html-editor" class="editor"></div>
                    <div id="css-editor" class="editor hidden"></div>
                    <div id="js-editor" class="editor hidden"></div>
                    <button class="copy-button" id="copy-html">Copy HTML</button>
                    <button class="copy-button" id="copy-css" style="top: 45px; right: 10px;">Copy CSS</button>
                    <button class="copy-button" id="copy-js" style="top: 80px; right: 10px;">Copy JS</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize variables
        let selectedElement = null;
        let htmlEditor, cssEditor, jsEditor;
        let isDragging = false;
        let dragOffset = { x: 0, y: 0 };
        let isResizing = false;
        let resizeDirection = null;
        let pageWidth = 1200;
        let pageHeight = 800;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeMonacoEditors();
            setupEventListeners();
            setupElementDragAndDrop();
            updatePageSizeIndicator();
        });

        // Initialize Monaco editors
        function initializeMonacoEditors() {
            require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.34.1/min/vs' }});
            require(['vs/editor/editor.main'], function() {
                htmlEditor = monaco.editor.create(document.getElementById('html-editor'), {
                    value: '<!-- Your HTML code will appear here -->\n<div class="container">\n  <h1>Hello World</h1>\n</div>',
                    language: 'html',
                    theme: 'vs-dark',
                    automaticLayout: true
                });

                cssEditor = monaco.editor.create(document.getElementById('css-editor'), {
                    value: '/* Your CSS code will appear here */\nbody {\n  font-family: Arial, sans-serif;\n}',
                    language: 'css',
                    theme: 'vs-dark',
                    automaticLayout: true
                });

                jsEditor = monaco.editor.create(document.getElementById('js-editor'), {
                    value: '// Your JavaScript code will appear here\nconsole.log("Hello World");',
                    language: 'javascript',
                    theme: 'vs-dark',
                    automaticLayout: true
                });
            });
        }

        // Update page size indicator
        function updatePageSizeIndicator() {
            document.getElementById('page-size-indicator').textContent = `Page: ${pageWidth}×${pageHeight}`;
        }

        // Set up event listeners
        function setupEventListeners() {
            // View toggle buttons
            document.getElementById('design-view-btn').addEventListener('click', function() {
                document.body.classList.remove('preview-mode');
                this.classList.add('active');
                document.getElementById('preview-view-btn').classList.remove('active');
                enableEditing();
            });

            document.getElementById('preview-view-btn').addEventListener('click', function() {
                document.body.classList.add('preview-mode');
                this.classList.add('active');
                document.getElementById('design-view-btn').classList.remove('active');
                generateCode();
                disableEditing();
            });

            // Code tabs
            document.querySelectorAll('.code-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    document.querySelectorAll('.code-tab').forEach(t => t.classList.remove('active'));
                    document.querySelectorAll('.editor').forEach(e => e.classList.add('hidden'));
                    
                    this.classList.add('active');
                    document.getElementById(`${this.dataset.tab}-editor`).classList.remove('hidden');
                });
            });

            // Copy buttons
            document.getElementById('copy-html').addEventListener('click', function() {
                const code = htmlEditor.getValue();
                copyToClipboard(code, this);
            });

            document.getElementById('copy-css').addEventListener('click', function() {
                const code = cssEditor.getValue();
                copyToClipboard(code, this);
            });

            document.getElementById('copy-js').addEventListener('click', function() {
                const code = jsEditor.getValue();
                copyToClipboard(code, this);
            });

            // Property inputs
            document.getElementById('prop-bg-color').addEventListener('input', updateElementProperties);
            document.getElementById('prop-width').addEventListener('change', updateElementProperties);
            document.getElementById('prop-height').addEventListener('change', updateElementProperties);
            document.getElementById('prop-text-color').addEventListener('input', updateElementProperties);
            document.getElementById('prop-text-content').addEventListener('change', updateElementProperties);
            document.getElementById('prop-link-url').addEventListener('change', updateElementProperties);
            document.getElementById('prop-font-size').addEventListener('change', updateElementProperties);
            document.getElementById('prop-border-radius').addEventListener('change', updateElementProperties);
            document.getElementById('prop-image-url').addEventListener('change', updateElementProperties);
            document.getElementById('prop-video-url').addEventListener('change', updateElementProperties);
            document.getElementById('prop-scroll-behavior').addEventListener('change', updateElementProperties);

            // Toolbar buttons
            document.getElementById('clear-all').addEventListener('click', function() {
                document.getElementById('design-area').innerHTML = '';
                generateCode();
            });

            document.getElementById('delete-element').addEventListener('click', function() {
                if (selectedElement) {
                    selectedElement.remove();
                    selectedElement = null;
                    generateCode();
                }
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', function(e) {
                // Delete key to remove selected element
                if (e.key === 'Delete' && selectedElement) {
                    selectedElement.remove();
                    selectedElement = null;
                    generateCode();
                }
            });

            // Page size adjustment
            document.getElementById('design-area').addEventListener('wheel', function(e) {
                if (e.ctrlKey) {
                    e.preventDefault();
                    if (e.deltaY < 0) {
                        // Zoom in
                        pageWidth = Math.min(2000, pageWidth + 50);
                        pageHeight = Math.min(2000, pageHeight + 50);
                    } else {
                        // Zoom out
                        pageWidth = Math.max(600, pageWidth - 50);
                        pageHeight = Math.max(400, pageHeight - 50);
                    }
                    document.getElementById('design-area').style.width = `${pageWidth}px`;
                    document.getElementById('design-area').style.height = `${pageHeight}px`;
                    updatePageSizeIndicator();
                }
            });
        }

        // Enable editing in design mode
        function enableEditing() {
            const elements = document.querySelectorAll('.element');
            elements.forEach(element => {
                element.style.pointerEvents = 'auto';
                element.style.cursor = 'move';
                element.querySelectorAll('button, input, textarea, select, a').forEach(el => {
                    el.style.pointerEvents = 'none';
                });
            });
        }

        // Disable editing in preview mode
        function disableEditing() {
            const elements = document.querySelectorAll('.element');
            elements.forEach(element => {
                element.style.pointerEvents = 'none';
                element.style.cursor = 'default';
                element.querySelectorAll('button, input, textarea, select, a').forEach(el => {
                    el.style.pointerEvents = 'auto';
                });
            });
        }

        // Copy text to clipboard and show feedback
        function copyToClipboard(text, button) {
            navigator.clipboard.writeText(text).then(() => {
                const originalText = button.textContent;
                button.textContent = 'Copied!';
                setTimeout(() => {
                    button.textContent = originalText;
                }, 2000);
            });
        }

        // Set up element drag and drop from sidebar
        function setupElementDragAndDrop() {
            const elementItems = document.querySelectorAll('.element-item');
            
            elementItems.forEach(item => {
                item.addEventListener('dragstart', function(e) {
                    e.dataTransfer.setData('text/plain', this.dataset.type);
                });
            });

            const designArea = document.getElementById('design-area');
            
            designArea.addEventListener('dragover', function(e) {
                e.preventDefault();
                // Show visual feedback that dropping is allowed
                e.dataTransfer.dropEffect = 'copy';
            });
            
            designArea.addEventListener('drop', function(e) {
                e.preventDefault();
                const type = e.dataTransfer.getData('text/plain');
                createNewElement(type, e.clientX, e.clientY);
            });
        }

        // Create a new element
        function createNewElement(type, x, y) {
            const designArea = document.getElementById('design-area');
            const rect = designArea.getBoundingClientRect();
            
            // Calculate position relative to design area
            const posX = x - rect.left - 50;
            const posY = y - rect.top - 25;
            
            const element = document.createElement('div');
            element.classList.add('element');
            element.dataset.type = type;
            
            // Set position
            element.style.left = `${posX}px`;
            element.style.top = `${posY}px`;
            
            // Create content based on type
            switch(type) {
                case 'button':
                    element.innerHTML = `
                        <div class="element-content">
                            <button class="button">Click Me</button>
                        </div>
                    `;
                    element.style.width = '120px';
                    element.style.height = '45px';
                    break;
                case 'navbar':
                    element.innerHTML = `
                        <div class="element-content">
                            <div class="navbar">
                                <div class="logo">Logo</div>
                                <div class="nav-links">
                                    <a href="#home" style="color: white; margin-right: 15px; text-decoration: none;">Home</a>
                                    <a href="#about" style="color: white; margin-right: 15px; text-decoration: none;">About</a>
                                    <a href="#contact" style="color: white; text-decoration: none;">Contact</a>
                                </div>
                            </div>
                        </div>
                    `;
                    element.style.width = '100%';
                    element.style.top = '0';
                    element.style.left = '0';
                    break;
                case 'image':
                    element.innerHTML = `
                        <div class="element-content">
                            <div class="image-placeholder">
                                <i class="fas fa-image" style="font-size: 24px;"></i>
                                <span style="margin-left: 8px;">Image</span>
                            </div>
                        </div>
                    `;
                    element.style.width = '200px';
                    element.style.height = '150px';
                    break;
                case 'modal':
                    element.innerHTML = `
                        <div class="element-content">
                            <div class="modal">
                                <h3>Modal Title</h3>
                                <p>This is a modal dialog. You can add any content here.</p>
                                <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
                                    <button class="button" style="margin-right: 10px;">Cancel</button>
                                    <button class="button">OK</button>
                                </div>
                            </div>
                        </div>
                    `;
                    element.style.width = '400px';
                    element.style.height = '200px';
                    break;
                case 'text':
                    element.innerHTML = `
                        <div class="element-content">
                            <div class="text-element">This is a text element. You can edit me!</div>
                        </div>
                    `;
                    element.style.width = '200px';
                    element.style.height = '60px';
                    break;
                case 'form':
                    element.innerHTML = `
                        <div class="element-content">
                            <div class="form-element">
                                <h3 style="margin-bottom: 15px; color: #333;">Contact Form</h3>
                                <div class="form-group">
                                    <label class="form-label">Name</label>
                                    <input type="text" class="form-input" placeholder="Your name">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Email</label>
                                    <input type="email" class="form-input" placeholder="Your email">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Message</label>
                                    <textarea class="form-input" placeholder="Your message" rows="3"></textarea>
                                </div>
                                <button class="button" style="margin-top: 10px;">Submit</button>
                            </div>
                        </div>
                    `;
                    element.style.width = '350px';
                    element.style.height = '380px';
                    break;
                case 'card':
                    element.innerHTML = `
                        <div class="element-content">
                            <div class="card">
                                <h3 style="margin-bottom: 10px; color: #333;">Card Title</h3>
                                <p style="color: #666; margin-bottom: 15px;">This is a card component. You can put any content inside it.</p>
                                <button class="button">Learn More</button>
                            </div>
                        </div>
                    `;
                    element.style.width = '250px';
                    element.style.height = '180px';
                    break;
                case 'video':
                    element.innerHTML = `
                        <div class="element-content">
                            <div class="video-container">
                                <i class="fas fa-video" style="font-size: 24px; margin-right: 8px;"></i>
                                <span>Video Player</span>
                            </div>
                        </div>
                    `;
                    element.style.width = '300px';
                    element.style.height = '200px';
                    break;
                case 'scroll-container':
                    element.innerHTML = `
                        <div class="element-content">
                            <div class="scroll-container" style="height: 100%;">
                                <h4>Scroll Container</h4>
                                <p>This content can be scrolled if it overflows.</p>
                                <div style="height: 300px; background: linear-gradient(to bottom, #f0f0f0, #e0e0e0); display: flex; align-items: center; justify-content: center;">
                                    Scrollable Content Area
                                </div>
                            </div>
                        </div>
                    `;
                    element.style.width = '300px';
                    element.style.height = '400px';
                    break;
                case 'section':
                    element.innerHTML = `
                        <div class="element-content" style="background-color: #f9f9f9; padding: 20px;">
                            <h2>Section Title</h2>
                            <p>This is a section container that can hold other elements.</p>
                        </div>
                    `;
                    element.style.width = '100%';
                    element.style.height = '200px';
                    break;
                case 'tabs':
                    element.innerHTML = `
                        <div class="element-content">
                            <div style="background-color: white; padding: 15px;">
                                <div style="display: flex; border-bottom: 1px solid #ddd;">
                                    <div style="padding: 10px 15px; border-bottom: 2px solid #007acc; margin-right: 5px;">Tab 1</div>
                                    <div style="padding: 10px 15px; color: #666; margin-right: 5px;">Tab 2</div>
                                    <div style="padding: 10px 15px; color: #666;">Tab 3</div>
                                </div>
                                <div style="padding: 15px;">
                                    <p>Tab 1 content goes here.</p>
                                </div>
                            </div>
                        </div>
                    `;
                    element.style.width = '400px';
                    element.style.height = '200px';
                    break;
                case 'accordion':
                    element.innerHTML = `
                        <div class="element-content">
                            <div style="background-color: white; padding: 15px;">
                                <div style="border: 1px solid #ddd; margin-bottom: 5px;">
                                    <div style="padding: 10px; background-color: #f5f5f5; font-weight: bold;">Accordion Item 1</div>
                                    <div style="padding: 10px;">Content for item 1 goes here.</div>
                                </div>
                                <div style="border: 1px solid #ddd; margin-bottom: 5px;">
                                    <div style="padding: 10px; background-color: #f5f5f5; font-weight: bold;">Accordion Item 2</div>
                                </div>
                                <div style="border: 1px solid #ddd;">
                                    <div style="padding: 10px; background-color: #f5f5f5; font-weight: bold;">Accordion Item 3</div>
                                </div>
                            </div>
                        </div>
                    `;
                    element.style.width = '350px';
                    element.style.height = '250px';
                    break;
                case 'grid':
                    element.innerHTML = `
                        <div class="element-content">
                            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; padding: 10px;">
                                <div style="background-color: #f0f0f0; padding: 15px; text-align: center;">Grid Item 1</div>
                                <div style="background-color: #f0f0f0; padding: 15px; text-align: center;">Grid Item 2</div>
                                <div style="background-color: #f0f0f0; padding: 15px; text-align: center;">Grid Item 3</div>
                                <div style="background-color: #f0f0f0; padding: 15px; text-align: center;">Grid Item 4</div>
                                <div style="background-color: #f0f0f0; padding: 15px; text-align: center;">Grid Item 5</div>
                                <div style="background-color: #f0f0f0; padding: 15px; text-align: center;">Grid Item 6</div>
                            </div>
                        </div>
                    `;
                    element.style.width = '500px';
                    element.style.height = '250px';
                    break;
                case 'div':
                    element.innerHTML = `
                        <div class="element-content" style="background-color: #f0f0f0; padding: 10px;">
                            Container
                        </div>
                    `;
                    element.style.width = '150px';
                    element.style.height = '100px';
                    break;
                case 'menu':
                    element.innerHTML = `
                        <div class="element-content">
                            <div style="background-color: #333; color: white; padding: 10px;">
                                <div style="margin-bottom: 8px;">
                                    <i class="fas fa-home" style="margin-right: 8px;"></i>
                                    <span>Home</span>
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <i class="fas fa-user" style="margin-right: 8px;"></i>
                                    <span>Profile</span>
                                </div>
                                <div style="margin-bottom: 8px;">
                                    <i class="fas fa-cog" style="margin-right: 8px;"></i>
                                    <span>Settings</span>
                                </div>
                                <div>
                                    <i class="fas fa-sign-out-alt" style="margin-right: 8px;"></i>
                                    <span>Logout</span>
                                </div>
                            </div>
                        </div>
                    `;
                    element.style.width = '150px';
                    element.style.height = '180px';
                    break;
                default:
                    element.innerHTML = `
                        <div class="element-content">
                            <div>${type}</div>
                        </div>
                    `;
                    element.style.width = '100px';
                    element.style.height = '100px';
                    element.style.backgroundColor = '#ddd';
            }
            
            // Add resize handles
            addResizeHandles(element);
            
            // Add event listeners for selection and dragging
            element.addEventListener('mousedown', startElementDrag);
            
            designArea.appendChild(element);
            selectElement(element);
            
            // Update code
            generateCode();
        }

        // Select an element
        function selectElement(element) {
            // Deselect previous element
            if (selectedElement) {
                selectedElement.classList.remove('selected');
            }
            
            // Select new element
            selectedElement = element;
            selectedElement.classList.add('selected');
            
            // Update properties panel
            updatePropertiesPanel();
        }

        // Start dragging an element
        function startElementDrag(e) {
            // Only handle left mouse button
            if (e.button !== 0) return;
            
            const element = e.target.closest('.element');
            if (!element) return;
            
            selectElement(element);
            
            // Calculate offset between mouse and element position
            const rect = element.getBoundingClientRect();
            dragOffset.x = e.clientX - rect.left;
            dragOffset.y = e.clientY - rect.top;
            
            // Set up event listeners for dragging
            document.addEventListener('mousemove', doElementDrag);
            document.addEventListener('mouseup', stopElementDrag);
            
            // Prevent text selection during drag
            e.preventDefault();
        }

        // Perform element dragging
        function doElementDrag(e) {
            if (!selectedElement) return;
            
            const designArea = document.getElementById('design-area');
            const designRect = designArea.getBoundingClientRect();
            
            // Calculate new position
            let newX = e.clientX - designRect.left - dragOffset.x;
            let newY = e.clientY - designRect.top - dragOffset.y;
            
            // Apply constraints to keep element within design area
            newX = Math.max(0, newX);
            newY = Math.max(0, newY);
            newX = Math.min(designRect.width - selectedElement.offsetWidth, newX);
            newY = Math.min(designRect.height - selectedElement.offsetHeight, newY);
            
            // Update element position
            selectedElement.style.left = `${newX}px`;
            selectedElement.style.top = `${newY}px`;
        }

        // Stop element dragging
        function stopElementDrag() {
            document.removeEventListener('mousemove', doElementDrag);
            document.removeEventListener('mouseup', stopElementDrag);
            
            // Update code after dragging
            generateCode();
        }

        // Add resize handles to an element
        function addResizeHandles(element) {
            const handles = ['nw', 'ne', 'sw', 'se'];
            
            handles.forEach(handle => {
                const div = document.createElement('div');
                div.classList.add('resize-handle', handle);
                div.addEventListener('mousedown', (e) => startResize(e, handle));
                element.appendChild(div);
            });
        }

        // Start resizing an element
        function startResize(e, direction) {
            e.stopPropagation();
            isResizing = true;
            resizeDirection = direction;
            
            const element = e.currentTarget.parentElement;
            selectElement(element);
            
            const startX = e.clientX;
            const startY = e.clientY;
            const startWidth = parseInt(element.style.width || element.offsetWidth);
            const startHeight = parseInt(element.style.height || element.offsetHeight);
            const startLeft = parseInt(element.style.left || 0);
            const startTop = parseInt(element.style.top || 0);
            
            function onMouseMove(moveEvent) {
                const dx = moveEvent.clientX - startX;
                const dy = moveEvent.clientY - startY;
                
                if (resizeDirection === 'nw') {
                    element.style.width = `${Math.max(50, startWidth - dx)}px`;
                    element.style.height = `${Math.max(30, startHeight - dy)}px`;
                    element.style.left = `${startLeft + dx}px`;
                    element.style.top = `${startTop + dy}px`;
                } else if (resizeDirection === 'ne') {
                    element.style.width = `${Math.max(50, startWidth + dx)}px`;
                    element.style.height = `${Math.max(30, startHeight - dy)}px`;
                    element.style.top = `${startTop + dy}px`;
                } else if (resizeDirection === 'sw') {
                    element.style.width = `${Math.max(50, startWidth - dx)}px`;
                    element.style.height = `${Math.max(30, startHeight + dy)}px`;
                    element.style.left = `${startLeft + dx}px`;
                } else if (resizeDirection === 'se') {
                    element.style.width = `${Math.max(50, startWidth + dx)}px`;
                    element.style.height = `${Math.max(30, startHeight + dy)}px`;
                }
            }
            
            function onMouseUp() {
                document.removeEventListener('mousemove', onMouseMove);
                document.removeEventListener('mouseup', onMouseUp);
                isResizing = false;
                resizeDirection = null;
                generateCode();
            }
            
            document.addEventListener('mousemove', onMouseMove);
            document.addEventListener('mouseup', onMouseUp);
            
            e.preventDefault();
        }

        // Update properties panel based on selected element
        function updatePropertiesPanel() {
            if (!selectedElement) return;
            
            // Get computed styles
            const style = window.getComputedStyle(selectedElement);
            
            // Update input values
            document.getElementById('prop-bg-color').value = rgbToHex(style.backgroundColor);
            document.getElementById('prop-width').value = style.width;
            document.getElementById('prop-height').value = style.height;
            document.getElementById('prop-text-color').value = rgbToHex(style.color);
            document.getElementById('prop-font-size').value = style.fontSize;
            document.getElementById('prop-border-radius').value = style.borderRadius;
            
            // Update text content if applicable
            const textElement = selectedElement.querySelector('div, p, h1, h2, h3, h4, h5, h6, span, button');
            if (textElement) {
                document.getElementById('prop-text-content').value = textElement.textContent;
            } else {
                document.getElementById('prop-text-content').value = '';
            }
            
            // Update link URL if applicable
            const linkElement = selectedElement.querySelector('a');
            if (linkElement) {
                document.getElementById('prop-link-url').value = linkElement.href;
            } else {
                document.getElementById('prop-link-url').value = '';
            }
            
            // Update image URL if applicable
            const imgElement = selectedElement.querySelector('img');
            if (imgElement) {
                document.getElementById('prop-image-url').value = imgElement.src;
            } else {
                document.getElementById('prop-image-url').value = '';
            }
            
            // Update video URL if applicable
            const videoElement = selectedElement.querySelector('video');
            if (videoElement) {
                document.getElementById('prop-video-url').value = videoElement.src;
            } else {
                document.getElementById('prop-video-url').value = '';
            }
            
            // Update scroll behavior if applicable
            const scrollContainer = selectedElement.querySelector('.scroll-container');
            if (scrollContainer) {
                document.getElementById('prop-scroll-behavior').value = scrollContainer.style.scrollBehavior || 'auto';
            }
        }

        // Update element properties based on property panel inputs
        function updateElementProperties() {
            if (!selectedElement) return;
            
            // Apply background color
            selectedElement.style.backgroundColor = document.getElementById('prop-bg-color').value;
            
            // Apply width and height
            selectedElement.style.width = document.getElementById('prop-width').value;
            selectedElement.style.height = document.getElementById('prop-height').value;
            
            // Apply text color to all child elements that might contain text
            const textColor = document.getElementById('prop-text-color').value;
            const textElements = selectedElement.querySelectorAll('div, p, h1, h2, h3, h4, h5, h6, span, button, a');
            textElements.forEach(el => {
                el.style.color = textColor;
            });
            
            // Apply font size
            const fontSize = document.getElementById('prop-font-size').value;
            if (fontSize) {
                selectedElement.querySelector('.element-content').style.fontSize = fontSize;
            }
            
            // Apply border radius
            const borderRadius = document.getElementById('prop-border-radius').value;
            if (borderRadius) {
                selectedElement.style.borderRadius = borderRadius;
            }
            
            // Apply text content
            const textContent = document.getElementById('prop-text-content').value;
            const firstTextElement = selectedElement.querySelector('div, p, h1, h2, h3, h4, h5, h6, span, button');
            if (firstTextElement && textContent) {
                firstTextElement.textContent = textContent;
            }
            
            // Apply link URL
            const linkUrl = document.getElementById('prop-link-url').value;
            const linkElement = selectedElement.querySelector('a');
            if (linkUrl) {
                if (linkElement) {
                    linkElement.href = linkUrl;
                } else {
                    // If there's a URL but no link element, wrap the content in an anchor tag
                    const content = selectedElement.querySelector('.element-content');
                    content.innerHTML = `<a href="${linkUrl}" style="color: inherit; text-decoration: none;">${content.innerHTML}</a>`;
                }
            }
            
            // Apply image URL
            const imageUrl = document.getElementById('prop-image-url').value;
            if (imageUrl) {
                const imgPlaceholder = selectedElement.querySelector('.image-placeholder');
                if (imgPlaceholder) {
                    imgPlaceholder.innerHTML = `<img src="${imageUrl}" alt="User image" style="width: 100%; height: 100%; object-fit: cover;">`;
                }
            }
            
            // Apply video URL
            const videoUrl = document.getElementById('prop-video-url').value;
            if (videoUrl) {
                const videoContainer = selectedElement.querySelector('.video-container');
                if (videoContainer) {
                    videoContainer.innerHTML = `
                        <video controls style="width: 100%; height: 100%;">
                            <source src="${videoUrl}" type="video/mp4">
                            Your browser does not support the video tag.
                        </video>
                    `;
                }
            }
            
            // Apply scroll behavior
            const scrollBehavior = document.getElementById('prop-scroll-behavior').value;
            const scrollContainer = selectedElement.querySelector('.scroll-container');
            if (scrollContainer) {
                scrollContainer.style.scrollBehavior = scrollBehavior;
            }
            
            generateCode();
        }

        // Generate code for all elements
        function generateCode() {
            const designArea = document.getElementById('design-area');
            let htmlCode = '<!DOCTYPE html>\n<html>\n<head>\n\t<title>Your Page</title>\n\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t<style>\n';
            
            // Generate CSS
            let cssCode = '\t\t* {\n\t\t\tbox-sizing: border-box;\n\t\t\tmargin: 0;\n\t\t\tpadding: 0;\n\t\t}\n\n';
            cssCode += '\t\tbody {\n\t\t\tfont-family: Arial, sans-serif;\n\t\t\tline-height: 1.6;\n\t\t\tcolor: #333;\n\t\t\tmax-width: 1200px;\n\t\t\tmargin: 0 auto;\n\t\t\tpadding: 20px;\n\t\t}\n';
            
            // Generate element HTML and CSS
            const elements = designArea.querySelectorAll('.element');
            elements.forEach((element, index) => {
                const type = element.dataset.type;
                const id = `element-${index}`;
                
                // Add HTML for the element
                htmlCode += `\t\t<div id="${id}">\n`;
                htmlCode += `\t\t\t${element.querySelector('.element-content').innerHTML}\n`;
                htmlCode += `\t\t</div>\n`;
                
                // Add CSS for the element
                const style = window.getComputedStyle(element);
                cssCode += `\n\t\t#${id} {\n`;
                cssCode += `\t\t\tposition: absolute;\n`;
                cssCode += `\t\t\tleft: ${element.style.left};\n`;
                cssCode += `\t\t\ttop: ${element.style.top};\n`;
                cssCode += `\t\t\twidth: ${element.style.width};\n`;
                cssCode += `\t\t\theight: ${element.style.height};\n`;
                
                if (element.style.backgroundColor && element.style.backgroundColor !== 'rgba(0, 0, 0, 0)') {
                    cssCode += `\t\t\tbackground-color: ${element.style.backgroundColor};\n`;
                }
                
                if (element.style.borderRadius) {
                    cssCode += `\t\t\tborder-radius: ${element.style.borderRadius};\n`;
                }
                
                cssCode += `\t\t}\n`;
            });
            
            htmlCode += '\t</style>\n</head>\n<body>\n';
            htmlCode += '</body>\n</html>';
            
            // Update editors
            if (htmlEditor) {
                htmlEditor.setValue(htmlCode);
            }
            
            if (cssEditor) {
                cssEditor.setValue(cssCode);
            }
        }

        // Helper function to convert RGB to Hex
        function rgbToHex(rgb) {
            if (!rgb || rgb === 'rgba(0, 0, 0, 0)') return '#ffffff';
            
            const rgbValues = rgb.match(/\d+/g);
            if (!rgbValues || rgbValues.length < 3) return '#ffffff';
            
            return '#' + 
                parseInt(rgbValues[0]).toString(16).padStart(2, '0') +
                parseInt(rgbValues[1]).toString(16).padStart(2, '0') +
                parseInt(rgbValues[2]).toString(16).padStart(2, '0');
        }
    </script>
</body>
</html>
