<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Web Designer Tool — Edit / View</title>
  <style>
    /* ---------- Reset & base ---------- */
    :root{
      --bg:#0b0f13; --panel:#0f1720; --muted:#9aa4b2; --accent:#6ee7b7; --accent-2:#7c5cff;
      --glass: rgba(255,255,255,0.03);
      --radius:12px; --shadow: 0 6px 20px rgba(2,6,23,0.7);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial;color:#d8e3ea;background:linear-gradient(180deg,var(--bg),#040608);}
    a{color:inherit}

    /* ---------- Layout ---------- */
    .app{display:grid;grid-template-columns:260px 1fr 360px;grid-template-rows:64px 1fr 220px;gap:16px;height:100vh;padding:16px}
    header{grid-column:1/4;display:flex;align-items:center;gap:16px;padding:12px;border-radius:12px;background:linear-gradient(180deg,var(--panel),rgba(255,255,255,0.02));box-shadow:var(--shadow)}

    /* left sidebar */
    .sidebar{background:var(--panel);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:12px}
    .sidebar h3{margin:0;font-size:13px;color:var(--muted)}
    .library{flex:1;overflow:auto;padding:6px;display:grid;grid-template-columns:1fr 1fr;gap:8px}
    .lib-item{cursor:grab;border-radius:10px;padding:10px;background:var(--glass);display:flex;align-items:center;justify-content:center;font-size:13px;color:var(--muted);border:1px solid rgba(255,255,255,0.02)}

    /* center workspace */
    .canvas-panel{display:flex;flex-direction:column;gap:12px}
    .toolbar{display:flex;align-items:center;gap:8px}
    .segmented{background:transparent;padding:6px;border-radius:10px;display:inline-flex;gap:6px}
    .segmented button{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);padding:8px 12px;border-radius:8px;cursor:pointer}
    .segmented button.active{background:linear-gradient(90deg,var(--accent-2),var(--accent));color:#071018;font-weight:600;border:none}

    .workwrap{display:flex;justify-content:center;align-items:flex-start;gap:12px}
    .device-frame{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:16px;border-radius:14px;border:1px solid rgba(255,255,255,0.03);box-shadow:0 10px 30px rgba(2,6,23,0.6)}

    /* the actual workspace (page div) */
    .page{width:100%;min-height:600px;background:linear-gradient(180deg,#05060a, #071018);border-radius:8px;padding:24px;overflow:auto;position:relative}
    .page .placeholder{color:var(--muted);opacity:0.7}

    /* right inspector */
    .inspector{background:var(--panel);border-radius:12px;padding:12px;display:flex;flex-direction:column;gap:12px}
    .inspector label{font-size:12px;color:var(--muted);display:block;margin-bottom:6px}
    .inspector input[type=text], .inspector select, .inspector textarea{width:100%;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:transparent;color:#dbe9ef}
    .inspector .row{display:flex;gap:8px}
    .inspector .row > *{flex:1}
    .small{font-size:12px;color:var(--muted)}

    /* bottom codegen */
    .code-panel{grid-column:1/4;display:flex;gap:12px}
    .code-box{flex:1;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.03);display:flex;flex-direction:column}
    .code-box pre{flex:1;background:transparent;border:none;color:#cfeff3;overflow:auto;margin:0;font-family:monospace;font-size:12px}
    .code-actions{display:flex;justify-content:space-between;align-items:center;gap:8px}
    .btn{background:linear-gradient(90deg,var(--accent-2),var(--accent));border:none;padding:8px 12px;border-radius:10px;color:#071018;cursor:pointer}
    .ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:10px;color:var(--muted);cursor:pointer}

    /* small helpers */
    .muted{color:var(--muted)}
    .split{display:flex;gap:8px}

    /* selectable outline */
    .selected{outline:2px dashed rgba(124,92,255,0.8);outline-offset:6px}

    /* default element styles inside page */
    .page button{padding:10px 14px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--accent-2),var(--accent));color:#071018;cursor:pointer}
    .page nav{display:flex;gap:12px;align-items:center}
    .page .card{background:#071322;padding:16px;border-radius:12px}

    /* responsive sizes (device frame widths) */
    .device-phone{width:360px}
    .device-tablet{width:820px}
    .device-laptop{width:1100px}

    /* small screens layout tweaks */
    @media (max-width:1100px){.app{grid-template-columns:240px 1fr;grid-template-rows:64px 1fr 300px}.inspector{display:none}.code-panel{grid-column:1/3}}
    @media (max-width:700px){.library{grid-template-columns:1fr 1fr}.sidebar{display:none}.app{grid-template-columns:1fr;grid-template-rows:64px 1fr 220px 260px}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div style="display:flex;align-items:center;gap:12px">
        <strong style="font-size:15px">Design Studio</strong>
        <span class="muted">— Edit & View</span>
      </div>

      <div style="margin-left:auto;display:flex;gap:8px;align-items:center">
        <div class="segmented" role="tablist">
          <button id="mode-edit" class="active">Edit</button>
          <button id="mode-view">View</button>
        </div>
        <div class="segmented" title="Device preview">
          <button id="dev-phone">Phone</button>
          <button id="dev-tablet">Tablet</button>
          <button id="dev-laptop" class="active">Laptop</button>
        </div>
        <button id="export" class="ghost">Export</button>
      </div>
    </header>

    <!-- left library -->
    <aside class="sidebar">
      <h3>Elements Library</h3>
      <div class="library" id="library">
        <div class="lib-item" data-snippet="<button>Click me</button>">Button</div>
        <div class="lib-item" data-snippet="<nav><a href='#'>Home</a><a href='#'>About</a><a href='#'>Contact</a></nav>">Navbar</div>
        <div class="lib-item" data-snippet="<header><h1>Headline</h1><p class='muted'>subtitle</p></header>">Header</div>
        <div class="lib-item" data-snippet="<section class='card'><h3>Card</h3><p>Card content</p></section>">Card</div>
        <div class="lib-item" data-snippet="<label>Text<input type='text' placeholder='Type...'></label>">Form</div>
        <div class="lib-item" data-snippet="<div class='switch' data-state='off'><span>Toggle</span></div>">Toggle</div>
        <div class="lib-item" data-snippet="<footer><p class='muted'>© 2025 Company</p></footer>">Footer</div>
        <div class="lib-item" data-snippet="<div class='modal'><div class='modal-body'><h3>Modal</h3><p>Modal content</p></div></div>">Modal</div>
        <div class="lib-item" data-snippet="<ul class='list'><li>Item 1</li><li>Item 2</li></ul>">List</div>
        <div class="lib-item" data-snippet="<div class='banner'><h2>Promo banner</h2></div>">Banner</div>
      </div>
      <div style="display:flex;gap:8px">
        <button id="clear" class="ghost">Clear</button>
        <button id="reset" class="ghost">Reset</button>
      </div>
    </aside>

    <!-- center canvas -->
    <main class="canvas-panel">
      <div class="toolbar">
        <div class="muted small">Drag an element from the left into the page. Select elements to edit properties on the right.</div>
      </div>

      <div class="workwrap">
        <div class="device-frame device-laptop" id="deviceFrame">
          <div class="page" id="page" contenteditable="false">
            <div class="placeholder">Drop elements here or click library items to add.</div>
          </div>
        </div>
      </div>
    </main>

    <!-- right inspector -->
    <aside class="inspector" id="inspector">
      <div>
        <div class="muted">Selected element</div>
        <div id="sel-path" class="small muted">none</div>
      </div>

      <div id="inspector-fields">
        <label>Type</label>
        <input type="text" id="prop-type" readonly />

        <label>Inner Text / HTML</label>
        <textarea id="prop-html" rows="3"></textarea>

        <div class="row">
          <div>
            <label>Font size (px)</label>
            <input id="prop-fs" type="text" />
          </div>
          <div>
            <label>Padding (px)</label>
            <input id="prop-pad" type="text" />
          </div>
        </div>

        <label>Background color</label>
        <input id="prop-bg" type="text" placeholder="#hex or css var" />

        <label>Text color</label>
        <input id="prop-color" type="text" placeholder="#hex or css var" />

        <label>Link / href</label>
        <input id="prop-href" type="text" placeholder="/page or https://..." />

        <div style="display:flex;gap:8px;margin-top:8px">
          <button id="apply" class="btn">Apply</button>
          <button id="remove" class="ghost">Remove</button>
        </div>
      </div>

      <div style="margin-top:auto;font-size:12px;color:var(--muted)">Pro tip: double-click an element on the page to quickly edit its text.</div>
    </aside>

    <!-- bottom code panel -->
    <section class="code-panel">
      <div class="code-box">
        <div class="code-actions"><strong>HTML</strong><div><button class="ghost" onclick="copyCode('html')">Copy</button></div></div>
        <pre id="code-html"></pre>
      </div>
      <div class="code-box">
        <div class="code-actions"><strong>CSS</strong><div><button class="ghost" onclick="copyCode('css')">Copy</button></div></div>
        <pre id="code-css"></pre>
      </div>
      <div class="code-box">
        <div class="code-actions"><strong>JS</strong><div><button class="ghost" onclick="copyCode('js')">Copy</button></div></div>
        <pre id="code-js"></pre>
      </div>
    </section>
  </div>

  <script>
    /* ---------- Basic state ---------- */
    const page = document.getElementById('page');
    const library = document.getElementById('library');
    const inspector = document.getElementById('inspector');
    const selPath = document.getElementById('sel-path');
    let selected = null;

    // device buttons
    const devPhone = document.getElementById('dev-phone');
    const devTablet = document.getElementById('dev-tablet');
    const devLaptop = document.getElementById('dev-laptop');
    const deviceFrame = document.getElementById('deviceFrame');

    // mode
    const modeEdit = document.getElementById('mode-edit');
    const modeView = document.getElementById('mode-view');

    // code outputs
    const codeHtml = document.getElementById('code-html');
    const codeCss = document.getElementById('code-css');
    const codeJs = document.getElementById('code-js');

    /* ---------- Utility helpers ---------- */
    function htmlEscape(s){return s.replace(/</g,'&lt;').replace(/>/g,'&gt;')}

    function updateSelectedPath(el){
      if(!el){selPath.textContent='none';return}
      const path = [];
      let cur = el;
      while(cur && cur !== page){
        let p = cur.tagName.toLowerCase();
        if(cur.id) p += '#'+cur.id;
        path.unshift(p);
        cur = cur.parentElement;
      }
      selPath.textContent = path.join(' > ');
    }

    /* ---------- Library interactions ---------- */
    library.querySelectorAll('.lib-item').forEach(item=>{
      item.addEventListener('click', ()=>{
        const snippet = item.dataset.snippet;
        const temp = document.createElement('div'); temp.innerHTML = snippet;
        const node = temp.firstElementChild;
        makeElementInteractive(node);
        page.appendChild(node);
        generateAll();
      });

      // drag to page (clone)
      item.draggable = true;
      item.addEventListener('dragstart', e=>{
        e.dataTransfer.setData('text/plain', item.dataset.snippet);
      });
    });

    page.addEventListener('dragover', e=>{e.preventDefault();});
    page.addEventListener('drop', e=>{
      e.preventDefault();
      const html = e.dataTransfer.getData('text/plain');
      if(!html) return;
      const temp = document.createElement('div'); temp.innerHTML = html;
      const el = temp.firstElementChild;
      makeElementInteractive(el);
      page.appendChild(el);
      generateAll();
    });

    document.getElementById('clear').addEventListener('click', ()=>{page.innerHTML='';generateAll();});
    document.getElementById('reset').addEventListener('click', ()=>{page.innerHTML='<div class="placeholder">Drop elements here or click library items to add.</div>';generateAll();});

    /* ---------- Make elements selectable & editable ---------- */
    function makeElementInteractive(el){
      // ensure it's an Element
      if(!(el instanceof Element)) return;
      el.tabIndex = 0;
      el.addEventListener('click', e=>{
        e.stopPropagation();
        selectElement(el);
      });
      el.addEventListener('dblclick', e=>{
        e.stopPropagation();
        // quick text edit
        const text = prompt('Edit HTML/InnerText', el.innerHTML);
        if(text!==null){el.innerHTML = text; generateAll();}
      });

      // allow nested elements to be interactively added
      Array.from(el.children).forEach(child=>makeElementInteractive(child));
    }

    // clicking outside deselects
    document.body.addEventListener('click', e=>{
      if(!page.contains(e.target)) return;
      if(e.target === page){deselect();}
    });

    function selectElement(el){
      deselect();
      selected = el;
      el.classList.add('selected');
      loadInspector(el);
      updateSelectedPath(el);
    }
    function deselect(){
      if(selected){selected.classList.remove('selected');}
      selected = null; loadInspector(null); updateSelectedPath(null);
    }

    /* ---------- Inspector bindings ---------- */
    const propType = document.getElementById('prop-type');
    const propHtml = document.getElementById('prop-html');
    const propFs = document.getElementById('prop-fs');
    const propPad = document.getElementById('prop-pad');
    const propBg = document.getElementById('prop-bg');
    const propColor = document.getElementById('prop-color');
    const propHref = document.getElementById('prop-href');
    const applyBtn = document.getElementById('apply');
    const removeBtn = document.getElementById('remove');

    function loadInspector(el){
      if(!el){propType.value=''; propHtml.value=''; propFs.value=''; propPad.value=''; propBg.value=''; propColor.value=''; propHref.value=''; return}
      propType.value = el.tagName.toLowerCase();
      propHtml.value = el.innerHTML;
      const style = getComputedStyle(el);
      propFs.value = parseInt(style.fontSize) || '';
      propPad.value = parseInt(style.padding) || '';
      propBg.value = el.style.backgroundColor || el.style.background || '';
      propColor.value = el.style.color || '';
      // if anchor
      const a = el.querySelector('a') || (el.tagName.toLowerCase()==='a' ? el : null);
      propHref.value = a ? (a.getAttribute('href')||'') : (el.getAttribute('href')||el.dataset.href||'');
    }

    applyBtn.addEventListener('click', ()=>{
      if(!selected) return alert('No element selected');
      selected.innerHTML = propHtml.value;
      if(propFs.value) selected.style.fontSize = propFs.value + 'px'; else selected.style.fontSize = '';
      if(propPad.value) selected.style.padding = propPad.value + 'px'; else selected.style.padding = '';
      selected.style.background = propBg.value || '';
      selected.style.color = propColor.value || '';
      // link handling
      if(propHref.value){
        // if selected is anchor -> set href
        if(selected.tagName.toLowerCase()==='a') selected.setAttribute('href', propHref.value);
        else{
          // wrap in anchor
          const a = document.createElement('a'); a.setAttribute('href', propHref.value);
          a.innerHTML = selected.outerHTML;
          selected.replaceWith(a);
          makeElementInteractive(a);
          selectElement(a);
        }
      }
      generateAll();
    });

    removeBtn.addEventListener('click', ()=>{ if(!selected) return; selected.remove(); selected=null; loadInspector(null); generateAll(); });

    /* ---------- Mode & device handling ---------- */
    function setDevice(kind){
      deviceFrame.classList.remove('device-phone','device-tablet','device-laptop');
      if(kind==='phone') deviceFrame.classList.add('device-phone');
      if(kind==='tablet') deviceFrame.classList.add('device-tablet');
      if(kind==='laptop') deviceFrame.classList.add('device-laptop');
      [devPhone,devTablet,devLaptop].forEach(b=>b.classList.remove('active'));
      if(kind==='phone') devPhone.classList.add('active');
      if(kind==='tablet') devTablet.classList.add('active');
      if(kind==='laptop') devLaptop.classList.add('active');
    }
    devPhone.addEventListener('click', ()=>setDevice('phone'));
    devTablet.addEventListener('click', ()=>setDevice('tablet'));
    devLaptop.addEventListener('click', ()=>setDevice('laptop'));

    function setMode(m){
      if(m==='edit'){
        modeEdit.classList.add('active'); modeView.classList.remove('active');
        document.querySelectorAll('.inspector, .library, .code-panel, header .segmented').forEach(n=>n.style.display='');
        page.contentEditable = false; // we manage editing via inspector
      } else {
        modeView.classList.add('active'); modeEdit.classList.remove('active');
        // hide all tool panels for clean view
        document.querySelectorAll('.inspector, .library, .code-panel').forEach(n=>n.style.display='none');
        page.contentEditable = false;
      }
    }
    modeEdit.addEventListener('click', ()=>setMode('edit'));
    modeView.addEventListener('click', ()=>setMode('view'));

    // initialize
    setDevice('laptop'); setMode('edit');

    /* ---------- Live code generation ---------- */
    function generateHTML(){
      // we will serialize the page innerHTML but keep inspector-only classes removed
      const clone = page.cloneNode(true);
      // remove selection outlines
      clone.querySelectorAll('.selected').forEach(n=>n.classList.remove('selected'));
      // remove placeholder when exporting
      clone.querySelectorAll('.placeholder').forEach(n=>n.remove());
      // flatten dataset attributes used by tool
      clone.querySelectorAll('[data-state]').forEach(n=>n.removeAttribute('data-state'));
      return '<!-- Generated HTML -->\n' + clone.innerHTML.trim();
    }
    function generateCSS(){
      // basic CSS to accompany the exported HTML
      return `/* Generated CSS - minimal reset */\n*{box-sizing:border-box}body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:#fff;color:#071018;padding:24px}\nbutton{padding:10px 14px;border-radius:10px;border:none;background:linear-gradient(90deg,#7c5cff,#6ee7b7);color:#071018}\n.card{background:#071322;color:#e6f7f3;padding:14px;border-radius:12px}\nnav{display:flex;gap:12px}\n`;
    }
    function generateJS(){
      // add simple JS skeleton for modal or toggles
      return `// Generated JS - minimal behaviors\ndocument.querySelectorAll('.switch').forEach(s=>{s.addEventListener('click',()=>{s.dataset.state = s.dataset.state==='on'?'off':'on';})});\n`;
    }

    function generateAll(){
      codeHtml.textContent = generateHTML();
      codeCss.textContent = generateCSS();
      codeJs.textContent = generateJS();
    }
    // initial
    generateAll();

    /* ---------- Copy helpers ---------- */
    function copyCode(kind){
      const text = kind==='html'?codeHtml.textContent: kind==='css'?codeCss.textContent: codeJs.textContent;
      navigator.clipboard.writeText(text).then(()=>alert(kind.toUpperCase()+ ' copied to clipboard'));}
    window.copyCode = copyCode;

    /* ---------- Export (download) ---------- */
    document.getElementById('export').addEventListener('click', ()=>{
      const full = `<!doctype html>\n<html>\n<head>\n<meta charset=\"utf-8\">\n<meta name=\"viewport\" content=\"width=device-width,initial-scale=1\">\n<title>Exported Page</title>\n<style>${generateCSS()}</style>\n</head>\n<body>\n${generateHTML()}\n<script>${generateJS()}<\/script>\n</body>\n</html>`;
      const blob = new Blob([full],{type:'text/html'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'exported-page.html'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    });

    /* ---------- make already existing page children interactive if any ---------- */
    Array.from(page.children).forEach(ch=>makeElementInteractive(ch));

    /* ---------- keyboard shortcuts ---------- */
    window.addEventListener('keydown', e=>{
      if(e.key==='Delete' && selected){selected.remove(); selected=null; generateAll();}
      if((e.ctrlKey||e.metaKey) && e.key==='s'){e.preventDefault(); document.getElementById('export').click();}
    });

    /* ---------- small polish: keep inspector in sync on clicks inside page ---------- */
    page.addEventListener('click', ()=>{generateAll();});
  </script>
</body>
</html>
