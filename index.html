<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag-and-Drop Webpage Builder</title>
    <style>
        /* Dark mode by default */
        body {
            background-color: #121212;
            color: #ffffff;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        * {
            transition: all 0.3s ease;
        }

        #header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background-color: #1e1e1e;
            border-bottom: 1px solid #333;
        }

        #devices {
            display: flex;
            gap: 10px;
        }

        .device-btn {
            background-color: #333;
            border: 1px solid #555;
            color: #fff;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
        }

        .device-btn:hover {
            background-color: #444;
        }

        .device-btn.active {
            background-color: #007bff;
            border-color: #007bff;
        }

        #mode-toggle {
            background-color: #333;
            border: 1px solid #555;
            color: #fff;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
        }

        #mode-toggle:hover {
            background-color: #444;
        }

        #main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        #sidebar {
            width: 250px;
            background-color: #1e1e1e;
            padding: 10px;
            border-right: 1px solid #333;
            overflow-y: auto;
        }

        .element {
            background-color: #333;
            padding: 10px;
            margin-bottom: 10px;
            cursor: grab;
            border-radius: 5px;
            user-select: none;
        }

        .element:hover {
            background-color: #444;
        }

        #editor {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            overflow: auto;
            padding: 20px;
        }

        #canvas {
            background-color: #fff;
            color: #000;
            min-height: 500px;
            width: 100%;
            max-width: 1200px;
            border: 1px solid #555;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
            position: relative;
        }

        #canvas.edit-mode {
            min-height: 100%;
        }

        #canvas.laptop {
            max-width: 1200px;
        }

        #canvas.tablet {
            max-width: 768px;
        }

        #canvas.phone {
            max-width: 375px;
        }

        #view-mode {
            flex: 1;
            display: none;
            flex-direction: column;
            padding: 20px;
        }

        #preview {
            background-color: #fff;
            color: #000;
            min-height: 500px;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto 20px;
            border: 1px solid #555;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        #code-areas {
            display: flex;
            gap: 10px;
            height: 200px;
        }

        .code-section {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        textarea {
            flex: 1;
            background-color: #1e1e1e;
            color: #fff;
            border: 1px solid #333;
            padding: 10px;
            font-family: monospace;
            resize: none;
            border-radius: 5px;
        }

        .copy-btn {
            background-color: #333;
            border: 1px solid #555;
            color: #fff;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 5px;
            margin-top: 5px;
        }

        .copy-btn:hover {
            background-color: #444;
        }

        .canvas-element {
            border: 1px dashed #ccc;
            padding: 10px;
            margin: 10px 0;
            position: relative;
            cursor: move;
        }

        .canvas-element:hover {
            border-color: #007bff;
        }

        .edit-panel {
            position: absolute;
            top: 0;
            right: 0;
            background: #222;
            color: #fff;
            padding: 10px;
            border-radius: 5px;
            display: none;
            z-index: 10;
        }

        .canvas-element:hover .edit-panel {
            display: block;
        }

        .edit-panel input, .edit-panel select {
            background: #333;
            color: #fff;
            border: 1px solid #555;
            padding: 5px;
            margin: 5px 0;
            border-radius: 3px;
        }

        @media (max-width: 768px) {
            #main {
                flex-direction: column;
            }

            #sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 1px solid #333;
                overflow-x: auto;
            }

            #editor, #view-mode {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div id="header">
        <div id="devices">
            <button class="device-btn active" data-size="laptop">Laptop</button>
            <button class="device-btn" data-size="tablet">Tablet</button>
            <button class="device-btn" data-size="phone">Phone</button>
        </div>
        <button id="mode-toggle">Switch to View Mode</button>
    </div>
    <div id="main">
        <div id="sidebar">
            <div class="element" draggable="true" data-type="navbar">Navbar</div>
            <div class="element" draggable="true" data-type="footer">Footer</div>
            <div class="element" draggable="true" data-type="icon">Icon</div>
            <div class="element" draggable="true" data-type="button">Button</div>
            <div class="element" draggable="true" data-type="section">Section</div>
            <div class="element" draggable="true" data-type="form">Form</div>
            <div class="element" draggable="true" data-type="image">Image</div>
            <div class="element" draggable="true" data-type="text">Text Block</div>
            <div class="element" draggable="true" data-type="hero">Hero Section</div>
            <div class="element" draggable="true" data-type="card">Card</div>
            <div class="element" draggable="true" data-type="carousel">Carousel</div>
            <div class="element" draggable="true" data-type="modal">Modal</div>
        </div>
        <div id="editor">
            <div id="canvas" class="laptop edit-mode"></div>
        </div>
        <div id="view-mode">
            <div id="preview"></div>
            <div id="code-areas">
                <div class="code-section">
                    <textarea id="html-code" readonly></textarea>
                    <button class="copy-btn" onclick="copyCode('html-code')">Copy HTML</button>
                </div>
                <div class="code-section">
                    <textarea id="css-code" readonly></textarea>
                    <button class="copy-btn" onclick="copyCode('css-code')">Copy CSS</button>
                </div>
                <div class="code-section">
                    <textarea id="js-code" readonly></textarea>
                    <button class="copy-btn" onclick="copyCode('js-code')">Copy JS</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const preview = document.getElementById('preview');
        const editor = document.getElementById('editor');
        const viewMode = document.getElementById('view-mode');
        const modeToggle = document.getElementById('mode-toggle');
        const htmlCode = document.getElementById('html-code');
        const cssCode = document.getElementById('css-code');
        const jsCode = document.getElementById('js-code');
        const deviceBtns = document.querySelectorAll('.device-btn');

        let isEditMode = true;
        let currentDevice = 'laptop';

        // Element templates
        const elementTemplates = {
            navbar: '<nav class="navbar">Navbar Content</nav>',
            footer: '<footer class="footer">Footer Content</footer>',
            icon: '<i class="icon">Icon</i>',
            button: '<button class="btn">Button</button>',
            section: '<section class="section">Section Content</section>',
            form: '<form class="form"><input type="text" placeholder="Input"></form>',
            image: '<img src="placeholder.jpg" alt="Image" class="image">',
            text: '<p class="text">Text Block</p>',
            hero: '<section class="hero"><h1>Hero Title</h1><p>Hero Subtitle</p></section>',
            card: '<div class="card"><h3>Card Title</h3><p>Card Content</p></div>',
            carousel: '<div class="carousel"><div>Slide 1</div><div>Slide 2</div></div>',
            modal: '<div class="modal"><div class="modal-content">Modal Content</div></div>'
        };

        // Corresponding CSS
        const baseCSS = `
.navbar { background: #333; color: #fff; padding: 10px; display: flex; justify-content: space-between; }
.footer { background: #222; color: #fff; padding: 10px; text-align: center; }
.icon { font-size: 24px; }
.btn { background: #007bff; color: #fff; padding: 5px 10px; border: none; cursor: pointer; border-radius: 3px; }
.section { padding: 20px; border: 1px solid #ccc; }
.form { display: flex; flex-direction: column; gap: 10px; }
.image { max-width: 100%; }
.text { font-size: 16px; }
.hero { background: #f0f0f0; padding: 40px; text-align: center; }
.card { border: 1px solid #ccc; padding: 15px; border-radius: 5px; }
.carousel { display: flex; overflow-x: auto; gap: 10px; }
.modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); }
.modal-content { background: #fff; color: #000; margin: 15% auto; padding: 20px; width: 70%; }
`;

        // Corresponding JS
        const baseJS = `
document.querySelectorAll('.btn').forEach(btn => {
    btn.addEventListener('click', () => alert('Button clicked!'));
});
document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('click', () => modal.style.display = 'block');
});
`;

        // Drag and drop setup
        document.querySelectorAll('.element').forEach(el => {
            el.addEventListener('dragstart', e => {
                e.dataTransfer.setData('type', el.dataset.type);
            });
        });

        canvas.addEventListener('dragover', e => {
            e.preventDefault();
        });

        canvas.addEventListener('drop', e => {
            e.preventDefault();
            const type = e.dataTransfer.getData('type');
            if (type && elementTemplates[type]) {
                const newElement = document.createElement('div');
                newElement.classList.add('canvas-element');
                newElement.innerHTML = elementTemplates[type];
                newElement.contentEditable = true;

                // Add edit panel
                const editPanel = document.createElement('div');
                editPanel.classList.add('edit-panel');
                editPanel.innerHTML = `
                    <input type="text" class="edit-text" placeholder="Edit text">
                    <input type="color" class="edit-bg" title="Background Color">
                    <input type="color" class="edit-text-color" title="Text Color">
                    <select class="edit-font-size">
                        <option value="12px">12px</option>
                        <option value="16px">16px</option>
                        <option value="20px">20px</option>
                        <option value="24px">24px</option>
                    </select>
                    <button onclick="this.parentElement.parentElement.remove(); updateCode();">Delete</button>
                `;
                newElement.appendChild(editPanel);

                canvas.appendChild(newElement);
                updateCode();
            }
        });

        // Editable element handlers
        canvas.addEventListener('input', e => {
            if (e.target.classList.contains('edit-text')) {
                const parent = e.target.closest('.canvas-element');
                const mainContent = parent.querySelector(':first-child');
                mainContent.textContent = e.target.value;
            }
            updateCode();
        });

        canvas.addEventListener('change', e => {
            const parent = e.target.closest('.canvas-element');
            const mainContent = parent.querySelector(':first-child');
            if (e.target.classList.contains('edit-bg')) {
                mainContent.style.backgroundColor = e.target.value;
            } else if (e.target.classList.contains('edit-text-color')) {
                mainContent.style.color = e.target.value;
            } else if (e.target.classList.contains('edit-font-size')) {
                mainContent.style.fontSize = e.target.value;
            }
            updateCode();
        });

        // Device size switch
        deviceBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                deviceBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentDevice = btn.dataset.size;
                canvas.className = currentDevice + ' edit-mode';
                preview.className = currentDevice;
                if (!isEditMode) {
                    updatePreview();
                }
            });
        });

        // Mode toggle
        modeToggle.addEventListener('click', () => {
            isEditMode = !isEditMode;
            if (isEditMode) {
                editor.style.display = 'flex';
                viewMode.style.display = 'none';
                modeToggle.textContent = 'Switch to View Mode';
                canvas.classList.add('edit-mode');
            } else {
                editor.style.display = 'none';
                viewMode.style.display = 'flex';
                modeToggle.textContent = 'Switch to Edit Mode';
                canvas.classList.remove('edit-mode');
                updatePreview();
            }
        });

        // Update code in textareas
        function updateCode() {
            htmlCode.value = canvas.innerHTML.replace(/<div class="edit-panel">.*?<\/div>/g, '');
            cssCode.value = baseCSS + '\n' + Array.from(canvas.querySelectorAll('.canvas-element > :first-child')).map(el => {
                return `.${el.className} {` + 
                    (el.style.backgroundColor ? ` background-color: ${el.style.backgroundColor};` : '') +
                    (el.style.color ? ` color: ${el.style.color};` : '') +
                    (el.style.fontSize ? ` font-size: ${el.style.fontSize};` : '') +
                    ' }';
            }).join('\n');
            jsCode.value = baseJS;
        }

        // Update preview
        function updatePreview() {
            preview.innerHTML = canvas.innerHTML.replace(/<div class="edit-panel">.*?<\/div>/g, '').replace(/ contenteditable="true"/g, '');
            preview.className = currentDevice;

            const style = document.createElement('style');
            style.textContent = cssCode.value;
            preview.appendChild(style);

            const script = document.createElement('script');
            script.textContent = jsCode.value;
            preview.appendChild(script);
        }

        // Copy code
        function copyCode(id) {
            const textarea = document.getElementById(id);
            textarea.select();
            document.execCommand('copy');
            alert('Code copied!');
        }

        // Listen for edits in canvas
        canvas.addEventListener('input', updateCode);
    </script>
