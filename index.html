<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grok Web Designer Tool</title>
    <style>
        /* Dark theme and modern look */
        :root {
            --bg-color: #1e1e1e;
            --text-color: #ffffff;
            --accent-color: #007bff;
            --border-color: #333333;
            --editor-bg: #252526;
            --button-bg: #007bff;
            --button-hover: #0056b3;
        }
        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }
        #toolbar {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background-color: #252526;
            border-bottom: 1px solid var(--border-color);
        }
        #toolbar button {
            background-color: var(--button-bg);
            color: white;
            border: none;
            padding: 8px 16px;
            margin-right: 5px;
            cursor: pointer;
            border-radius: 4px;
            transition: background-color 0.3s;
        }
        #toolbar button:hover {
            background-color: var(--button-hover);
        }
        #main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        #sidebar {
            width: 250px;
            background-color: #252526;
            border-right: 1px solid var(--border-color);
            padding: 10px;
            overflow-y: auto;
        }
        #sidebar h3 {
            margin-top: 0;
        }
        #elements-list button {
            display: block;
            width: 100%;
            margin-bottom: 5px;
            background-color: var(--button-bg);
            color: white;
            border: none;
            padding: 8px;
            cursor: pointer;
            border-radius: 4px;
        }
        #elements-list button:hover {
            background-color: var(--button-hover);
        }
        #properties {
            margin-top: 20px;
        }
        #properties input, #properties select {
            width: 100%;
            margin-bottom: 10px;
            padding: 5px;
            background-color: #333333;
            color: var(--text-color);
            border: 1px solid var(--border-color);
            border-radius: 4px;
        }
        #work-area-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        #work-area {
            flex: 1;
            background-color: #ffffff; /* White for editing, but we'll make preview dark if needed */
            position: relative;
            overflow: auto;
            border: 1px solid var(--border-color);
            margin: 10px;
        }
        #work-area.edit-mode .element {
            border: 1px dashed #007bff;
            cursor: move;
            resize: both;
            overflow: auto;
            position: absolute;
        }
        #work-area.preview-mode {
            background-color: var(--bg-color);
        }
        #work-area.preview-mode .element {
            border: none;
            resize: none;
            cursor: default;
            position: absolute;
        }
        #code-section {
            display: flex;
            flex: 1;
            overflow: hidden;
            border-top: 1px solid var(--border-color);
        }
        .code-editor {
            flex: 1;
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
        }
        .code-editor:last-child {
            border-right: none;
        }
        .editor-header {
            display: flex;
            justify-content: space-between;
            padding: 5px;
            background-color: #252526;
        }
        .editor-header span {
            font-weight: bold;
        }
        .editor-header button {
            background-color: var(--button-bg);
            color: white;
            border: none;
            padding: 4px 8px;
            cursor: pointer;
            border-radius: 4px;
        }
        .editor-header button:hover {
            background-color: var(--button-hover);
        }
        #monaco-html, #monaco-css, #monaco-js {
            flex: 1;
            min-height: 200px;
        }
        /* Hide code section initially, toggle visibility */
        #code-section {
            height: 40%; /* Adjustable */
        }
    </style>
    <!-- Monaco Editor CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs/loader.min.js"></script>
</head>
<body>
    <div id="toolbar">
        <div>
            <button onclick="addElement('div')">Add Div</button>
            <button onclick="addElement('button')">Add Button</button>
            <button onclick="addElement('img')">Add Image</button>
            <button onclick="addElement('nav')">Add Navbar</button>
            <button onclick="addElement('a')">Add Link</button>
            <button onclick="addElement('video')">Add Video</button>
            <button onclick="addElement('modal')">Add Modal</button>
        </div>
        <div>
            <button onclick="toggleView()">Toggle Preview/Edit</button>
        </div>
    </div>
    <div id="main">
        <div id="sidebar">
            <h3>Properties</h3>
            <div id="properties">
                <!-- Dynamic properties will be injected here -->
            </div>
        </div>
        <div id="work-area-container">
            <div id="work-area" class="edit-mode"></div>
        </div>
    </div>
    <div id="code-section">
        <div class="code-editor">
            <div class="editor-header">
                <span>HTML</span>
                <button onclick="copyCode('html')">Copy</button>
            </div>
            <div id="monaco-html"></div>
        </div>
        <div class="code-editor">
            <div class="editor-header">
                <span>CSS</span>
                <button onclick="copyCode('css')">Copy</button>
            </div>
            <div id="monaco-css"></div>
        </div>
        <div class="code-editor">
            <div class="editor-header">
                <span>JavaScript</span>
                <button onclick="copyCode('js')">Copy</button>
            </div>
            <div id="monaco-js"></div>
        </div>
    </div>

    <script>
        let selectedElement = null;
        let isEditMode = true;
        let elementCounter = 0;
        let jsCode = ''; // For now, minimal JS support

        // Initialize Monaco Editors
        require.config({ paths: { 'vs': 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.44.0/min/vs' } });
        require(['vs/editor/editor.main'], function() {
            window.htmlEditor = monaco.editor.create(document.getElementById('monaco-html'), {
                value: '',
                language: 'html',
                theme: 'vs-dark',
                automaticLayout: true
            });
            window.cssEditor = monaco.editor.create(document.getElementById('monaco-css'), {
                value: '',
                language: 'css',
                theme: 'vs-dark',
                automaticLayout: true
            });
            window.jsEditor = monaco.editor.create(document.getElementById('monaco-js'), {
                value: '',
                language: 'javascript',
                theme: 'vs-dark',
                automaticLayout: true
            });
        });

        // Add element to work area
        function addElement(type) {
            const workArea = document.getElementById('work-area');
            const el = document.createElement(type);
            el.id = `el-${elementCounter++}`;
            el.classList.add('element');
            el.style.position = 'absolute';
            el.style.left = '50px';
            el.style.top = '50px';
            el.style.width = '100px';
            el.style.height = '50px';
            el.style.backgroundColor = '#f0f0f0'; // Default light for visibility in edit

            if (type === 'button') {
                el.innerText = 'Button';
                el.onclick = () => {}; // Can add JS later
            } else if (type === 'img') {
                el.src = 'https://via.placeholder.com/100x50';
                el.alt = 'Image';
            } else if (type === 'nav') {
                el.innerHTML = '<ul><li>Item 1</li><li>Item 2</li></ul>';
                el.style.backgroundColor = '#333';
                el.style.color = '#fff';
                el.style.padding = '10px';
                el.style.width = '100%';
                el.style.height = 'auto';
            } else if (type === 'a') {
                el.href = '#';
                el.innerText = 'Link';
            } else if (type === 'video') {
                el.src = 'https://www.w3schools.com/html/mov_bbb.mp4';
                el.controls = true;
                el.style.width = '200px';
            } else if (type === 'modal') {
                el.innerHTML = '<div>Modal Content</div>';
                el.style.backgroundColor = 'rgba(0,0,0,0.5)';
                el.style.display = 'none'; // Hidden by default
            } else {
                el.innerText = 'Div Content';
                el.contentEditable = true;
            }

            workArea.appendChild(el);
            makeDraggable(el);
            makeResizable(el);
            el.addEventListener('click', selectElement);
            updateCode();
        }

        // Make element draggable
        function makeDraggable(el) {
            let pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
            el.onmousedown = dragMouseDown;

            function dragMouseDown(e) {
                if (!isEditMode) return;
                e.preventDefault();
                pos3 = e.clientX;
                pos4 = e.clientY;
                document.onmouseup = closeDragElement;
                document.onmousemove = elementDrag;
            }

            function elementDrag(e) {
                e.preventDefault();
                pos1 = pos3 - e.clientX;
                pos2 = pos4 - e.clientY;
                pos3 = e.clientX;
                pos4 = e.clientY;
                el.style.top = (el.offsetTop - pos2) + "px";
                el.style.left = (el.offsetLeft - pos1) + "px";
                updateCode();
            }

            function closeDragElement() {
                document.onmouseup = null;
                document.onmousemove = null;
            }
        }

        // Make element resizable (using CSS resize)
        function makeResizable(el) {
            // Already set in CSS for edit-mode
        }

        // Select element and show properties
        function selectElement(e) {
            if (!isEditMode) return;
            e.stopPropagation();
            selectedElement = e.target;
            const properties = document.getElementById('properties');
            properties.innerHTML = '';

            // Common properties
            addPropertyInput('width', selectedElement.style.width, (val) => { selectedElement.style.width = val; updateCode(); });
            addPropertyInput('height', selectedElement.style.height, (val) => { selectedElement.style.height = val; updateCode(); });
            addPropertyInput('backgroundColor', selectedElement.style.backgroundColor, (val) => { selectedElement.style.backgroundColor = val; updateCode(); });
            addPropertyInput('color', selectedElement.style.color, (val) => { selectedElement.style.color = val; updateCode(); });
            addPropertyInput('fontSize', selectedElement.style.fontSize, (val) => { selectedElement.style.fontSize = val; updateCode(); });

            // Type-specific
            if (selectedElement.tagName === 'BUTTON' || selectedElement.tagName === 'A') {
                addPropertyInput('link', selectedElement.href || '', (val) => { selectedElement.href = val; updateCode(); });
                addPropertyInput('text', selectedElement.innerText, (val) => { selectedElement.innerText = val; updateCode(); });
            } else if (selectedElement.tagName === 'IMG' || selectedElement.tagName === 'VIDEO') {
                addPropertyInput('src', selectedElement.src, (val) => { selectedElement.src = val; updateCode(); });
            } else if (selectedElement.tagName === 'NAV') {
                addPropertyInput('content', selectedElement.innerHTML, (val) => { selectedElement.innerHTML = val; updateCode(); });
            } else {
                addPropertyInput('text', selectedElement.innerText, (val) => { selectedElement.innerText = val; updateCode(); });
            }

            // For modals, add show/hide JS if needed
            if (selectedElement.tagName === 'DIV' && selectedElement.classList.contains('modal')) {
                // Basic JS for modal, but for now, placeholder
            }
        }

        function addPropertyInput(label, value, onChange) {
            const properties = document.getElementById('properties');
            const div = document.createElement('div');
            div.innerHTML = `<label>${label}</label>`;
            const input = document.createElement('input');
            input.value = value;
            input.oninput = (e) => onChange(e.target.value);
            div.appendChild(input);
            properties.appendChild(div);
        }

        // Toggle between edit and preview
        function toggleView() {
            const workArea = document.getElementById('work-area');
            isEditMode = !isEditMode;
            if (isEditMode) {
                workArea.classList.remove('preview-mode');
                workArea.classList.add('edit-mode');
                workArea.style.backgroundColor = '#ffffff';
            } else {
                workArea.classList.remove('edit-mode');
                workArea.classList.add('preview-mode');
                workArea.style.backgroundColor = var(--bg-color);
                // In preview, execute any JS if present
                eval(jsCode);
            }
        }

        // Update code in editors
        function updateCode() {
            const workArea = document.getElementById('work-area');
            let html = '<div id="page">';
            let css = '#page { position: relative; }\n';

            Array.from(workArea.children).forEach(el => {
                const id = el.id;
                html += el.outerHTML.replace(/position: absolute;/g, '').replace(/left: .*?px;/g, '').replace(/top: .*?px;/g, '') + '\n';
                css += `#${id} { position: absolute; left: ${el.style.left}; top: ${el.style.top}; width: ${el.style.width}; height: ${el.style.height}; background-color: ${el.style.backgroundColor}; color: ${el.style.color}; font-size: ${el.style.fontSize}; }\n`;
            });
            html += '</div>';

            // JS minimal, e.g., for buttons or modals
            jsCode = '// Add your JS here\n';
            if (document.querySelector('button')) {
                jsCode += 'document.querySelector("button").addEventListener("click", () => { console.log("Button clicked"); });\n';
            }

            htmlEditor.setValue(html);
            cssEditor.setValue(css);
            jsEditor.setValue(jsCode);
        }

        // Copy code
        function copyCode(type) {
            let text;
            if (type === 'html') text = htmlEditor.getValue();
            else if (type === 'css') text = cssEditor.getValue();
            else if (type === 'js') text = jsEditor.getValue();
            navigator.clipboard.writeText(text).then(() => alert('Copied!'));
        }

        // Listen for changes in work area (e.g., resize)
        const workArea = document.getElementById('work-area');
        workArea.addEventListener('mouseup', updateCode); // Update after resize/drag
        workArea.addEventListener('input', updateCode); // For contenteditable
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
</body>
</html>
